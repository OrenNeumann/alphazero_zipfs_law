# AlphaZero Neural Scaling and Zipf's Law: a Tale of Board Games and Power Laws

We provide here all resources needed to reproduce the paper's results.
To set up and run all experiments, go to the project folder and run:
```
poetry install
poetry shell
```
This will generate all plots in the `plots` dir. By default, saved data is used to generate all results.
The data is provided in a dedicated release (_Experiment data_). Download the _.zip_ files and place them in a new folder named `plot_data` next to the project folder:
```
parent_directory/
│
├── project_folder/
│   ├── src/
│   │   └── ...
│   ├── README.md
│   └── ...
│
├── plot_data/
│   ├── ab_pruning.zip
│   ├── board_positions.zip
│   └── ...
```
Unzip all files inside `plot_data` then run:
```
python -m src.generate_all_plots
```
To run all experiments _from scratch_, change the flag `load_data` in `src.generate_all_plots` to `False`. Reproducing the results this way can take several hours to generate all plots. See further instructions in [Generating all results from scratch](#generating-all-results-from-scratch).

## Hardware requirements

All experiments ran on a single node with 64 CPU cores and 125Gi RAM.

## Generating all results from scratch

Some experiments require importing or installing 3rd party data and software manually:
- Almost all experiments require agent training/inference data, and the trained agents. 
    These can be generated by OpenSpiel (Apache License 2.0) with the code available [here](https://github.com/OrenNeumann/AlphaZero-scaling-laws) (Apache License 2.0).
- Experiments calculating agent Elo require installing the [Bayeselo tool](https://www.remi-coulom.fr/Bayesian-Elo/) (GNU General Public License v3.0), and the Python API available [here](https://github.com/yytdfc/Bayesian-Elo) (GNU General Public License v3.0).
- Experiments using the Connect Four solver (`connect4_loss_plots` and `plot_policy_degradation`) require installing the solver available [here](https://github.com/PascalPons/connect4) (GNU Affero General Public License v3.0). The opening book, available as a release in the GitHub repo, should be saved in the project folder.
- The alpha-beta pruning experiment in `connect4_loss_plots` requires that the solver opening book is NOT present in the 
    parent dir (forcing the solver to perform a full search without prior data). Remove it before starting this experiment.